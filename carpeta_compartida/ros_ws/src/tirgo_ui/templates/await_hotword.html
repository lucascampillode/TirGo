{% extends "base.html" %}
{% block title %}TirGoPharma · Dime “hola”{% endblock %}

{% block content %}
<section class="hero">
  <h2>Di “hola, Tirgo”</h2>
  <p class="muted">Estoy escuchando… Cuando te oiga, desbloquearé las opciones.</p>

  {# Botón demo opcional: solo si TIRGO_DEV=1 y existe el endpoint simulate_hola #}
  <form method="post" action="{{ url_for('main.simulate_hola') }}" onsubmit="setTimeout(()=>location.reload(),300);" style="margin-top:1rem;">
    <button class="btn ghost">Simular “hola” (demo)</button>
  </form>
</section>
{% endblock %}

{% block scripts %}
<script>
  // Consultar si la sesión está activa (nuevo modelo sin “ventana”)
  async function tick() {
    try {
      const r = await fetch('/session_status', { cache: 'no-store' });
      const j = await r.json();
      if (j && j.active) { location.reload(); return; }
    } catch (e) { /* noop */ }
    setTimeout(tick, 800);
  }
  tick();
</script>
{% endblock %}
